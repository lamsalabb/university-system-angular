<main class="page-container">

  <div class="list-header">
    <h3 class="list-title">Attendance Overview</h3>
  </div>

  <div class="list-card">

    @if (summary()) {
      <div class="summary-section">

        <div class="summary-chart">
          <canvas
            [data]="chartData()"
            [type]="'pie'"
            baseChart>
          </canvas>
        </div>

        <div class="summary-stats">
          <div>Total Sessions: {{ summary().totalSessions }}</div>
          <div>Present: {{ summary().presentCount }}</div>
          <div>Absent: {{ summary().absentCount }}</div>
          <div>Excused: {{ summary().excusedCount }}</div>
          <strong>
            Attendance: {{ summary().presentPercent | number:'1.0-2' }}%
          </strong>
        </div>

      </div>
    }

    <div class="course-buttons">
      @for (c of courses(); track c.id) {
        <button
          (click)="loadSummary(c.id)"
          [class.active]="selectedCourseId() === c.id"
          class="secondary-button small-button"
        >
          {{ c.title }}
        </button>
      }
    </div>

    <table class="data-table">

      <thead>
      <tr>
        <th>Course</th>
        <th>Date</th>
        <th>Status</th>
        <th>Remarks</th>
      </tr>
      </thead>

      <tbody>
        @if (attendance().length === 0) {
          <tr>
            <td class="empty-row" colspan="4">
              No attendance records available.
            </td>
          </tr>
        }

        @for (a of attendance(); track a.id) {
          <tr>
            <td>{{ a.course.title }}</td>
            <td>{{ a.sessionDate }}</td>
            <td>
              <span
                [class.danger]="a.status === 'ABSENT'"
                [class.success]="a.status === 'PRESENT'"
                [class.warning]="a.status === 'EXCUSED'"
                class="status-badge"
              >
                {{ a.status }}
              </span>
            </td>
            <td>{{ a.remarks ?? 'â€”' }}</td>
          </tr>
        }
      </tbody>

    </table>

  </div>

</main>

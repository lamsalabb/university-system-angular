<main class="page-container">

  @if (loading()) {
    <p class="muted-text">Loading profileâ€¦</p>
  }

  @if (error()) {
    <p class="error-text">{{ error() }}</p>
  }

  @if (!loading() && !error() && student()) {

    <div class="centered-container">

      <div class="card">

        <div class="card-body text-center">

          <div class="avatar-wrapper">
            <div class="avatar-circle primary">
              {{ student()!.firstName.charAt(0) }}
            </div>
          </div>

          <h4 class="title">
            {{ student()!.firstName }} {{ student()!.lastName }}
          </h4>

          <span class="badge info">STUDENT</span>

          <hr>

          <div class="details">

            <p class="center">
              <strong>Email: </strong>
              <span>{{ student()!.email }}</span>
            </p>

            <p class="center">
              <strong>Status: </strong>
              <span
                [class.muted]="!student()!.active"
                [class.success]="student()!.active"
                class="status-badge"
              >
                {{ student()!.active ? 'Active' : 'Inactive' }}
              </span>
            </p>

            <div class="center">

              @if (!showChangePassword()) {
                <button
                  (click)="showChangePassword.set(true)"
                  class="link-button"
                  type="button"
                >
                  Change password
                </button>
              }

            </div>

            @if (showChangePassword()) {

              <hr>

              <form (ngSubmit)="submitPasswordChange()" class="form-layout">

                <div class="form-field">
                  <label class="form-label">Current password</label>
                  <input
                    [(ngModel)]="currentPassword"
                    class="form-input"
                    name="currentPassword"
                    required
                    type="password"
                  >
                </div>

                <div class="form-field">
                  <label class="form-label">New password</label>
                  <input
                    [(ngModel)]="newPassword"
                    class="form-input"
                    name="newPassword"
                    required
                    type="password"
                  >
                </div>

                <div class="form-field">
                  <label class="form-label">Confirm password</label>
                  <input
                    [(ngModel)]="confirmPassword"
                    class="form-input"
                    name="confirmPassword"
                    required
                    type="password"
                  >
                </div>

                @if (passwordError()) {
                  <p class="error-text center">{{ passwordError() }}</p>
                }


                <div class="form-actions">
                  <button
                    (click)="showChangePassword.set(false)"
                    class="secondary-button"
                    type="button"
                  >
                    Cancel
                  </button>

                  <button
                    class="primary-button"
                    type="submit"
                  >
                    Update password
                  </button>
                </div>

              </form>

            }

          </div>

        </div>

      </div>

    </div>

  }

</main>

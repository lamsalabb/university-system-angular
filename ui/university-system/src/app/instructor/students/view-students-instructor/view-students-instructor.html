<main class="page-container">

  <div class="list-header">
    <h3 class="list-title">Students</h3>
  </div>

  <div class="list-card">

    <table class="data-table">

      <thead>
      <tr>
        <th>ID</th>
        <th>Student Name</th>
        <th>Course Title</th>
        <th>Semester</th>
        <th class="center">Grade</th>
        <th class="center">Status</th>
        <th>Enrollment Date</th>
        <th class="center">Update Grade</th>
      </tr>
      </thead>

      <tbody>

        @if (enrollments().length === 0) {
          <tr>
            <td class="empty-row" colspan="8">
              No enrollments found.
            </td>
          </tr>
        }

        @for (e of enrollments(); track e.id) {
          <tr>
            <td>{{ e.id }}</td>
            <td>{{ e.student.firstName }} {{ e.student.lastName }}</td>
            <td>{{ e.course.title }}</td>
            <td>{{ e.semester }}</td>

            <td class="center">
              {{ e.grade ?? 'â€”' }}
            </td>

            <td class="center">
              <span
                [class.muted]="e.status !== 'ENROLLED'"
                [class.success]="e.status === 'ENROLLED'"
                class="status-badge"
              >
                {{ e.status }}
              </span>
            </td>

            <td>{{ e.enrollmentDate }}</td>

            <td class="center">
              <form
                (ngSubmit)="updateGrade(e.id, e.grade)"
                class="inline-form"
              >
                <select
                  [(ngModel)]="e.grade"
                  [disabled]="e.status === 'DROPPED'"
                  class="form-input small-input"
                  name="grade-{{ e.id }}"
                >
                  <option value="">--</option>

                  @for (g of grades; track g) {
                    <option [value]="g">
                      {{ g }}
                    </option>
                  }
                </select>

                <button
                  [disabled]="e.status === 'DROPPED'"
                  class="primary-button small-button"
                  type="submit"
                >
                  Save
                </button>
              </form>
            </td>
          </tr>
        }

      </tbody>

    </table>

  </div>

  <app-pagination
    (pageChange)="currentPage.set($event)"
    (sizeChange)="pageSize.set($event); currentPage.set(0)"
    [loading]="loading()"
    [page]="currentPage()"
    [size]="pageSize()"
    [total]="totalElements()"
  ></app-pagination>

</main>

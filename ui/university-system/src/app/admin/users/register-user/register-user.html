<main class="page-container">
  <div class="form-page">
    <div class="form-card">

      @if (loading()) {
        <div class="loader-overlay">
          <mat-progress-spinner
            color="primary"
            diameter="60"
            mode="indeterminate">
          </mat-progress-spinner>
        </div>
      }

      <h4 class="form-title">Register New User</h4>

      <form
        (ngSubmit)="submit()"
        [formGroup]="userForm"
        class="form-layout">

        <div class="form-field">
          <label class="form-label">Email</label>
          <input
            class="form-input"
            formControlName="email"
            placeholder="user@uni.edu"
            type="email"
          >
          @if ((userForm.get('email')?.touched || submitted()) && userForm.get('email')?.hasError('required')) {
            <small class="error-text">Email is required</small>
          }
          @if ((userForm.get('email')?.touched || submitted()) && userForm.get('email')?.hasError('email')) {
            <small class="error-text">Enter a valid email</small>
          }
        </div>

        <div class="form-field">
          <label class="form-label">Temporary Password</label>
          <input
            class="form-input"
            formControlName="password"
            placeholder="********"
            type="password"
          >
          @if ((userForm.get('password')?.touched || submitted()) && userForm.get('password')?.hasError('required')) {
            <small class="error-text">Password is required</small>
          }
          @if ((userForm.get('password')?.touched || submitted()) && userForm.get('password')?.hasError('minlength')) {
            <small class="error-text">Password must be at least 6 characters</small>
          }
        </div>

        <div class="form-field">
          <label class="form-label">Role</label>
          <select
            class="form-input"
            formControlName="role"
          >
            <option value="">Select role</option>
            <option value="ADMIN">Admin</option>
            <option value="INSTRUCTOR">Instructor</option>
            <option value="STUDENT">Student</option>
          </select>
          @if ((userForm.get('role')?.touched || submitted()) && userForm.get('role')?.invalid) {
            <small class="error-text">Role is required</small>
          }
        </div>

        <div class="form-row">
          <div class="form-field">
            <label class="form-label">First Name</label>
            <input
              class="form-input"
              formControlName="firstName"
              placeholder="First name"
            >
            @if ((userForm.get('firstName')?.touched || submitted()) && userForm.get('firstName')?.invalid) {
              <small class="error-text">First name is required</small>
            }
          </div>

          <div class="form-field">
            <label class="form-label">Last Name</label>
            <input
              class="form-input"
              formControlName="lastName"
              placeholder="Last name"
            >
            @if ((userForm.get('lastName')?.touched || submitted()) && userForm.get('lastName')?.invalid) {
              <small class="error-text">Last name is required</small>
            }
          </div>
        </div>

        <div class="form-actions">
          <button
            class="primary-button"
            type="submit"
          >
            Create User
          </button>
        </div>
      </form>
    </div>
  </div>
</main>
